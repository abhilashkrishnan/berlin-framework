allprojects {
	apply plugin: 'java'

	group = 'org.berlinframework'
	version = '0.1'
}

subprojects {
	apply plugin: 'java'
	apply plugin: 'java-library-distribution'

	sourceCompatibility = 1.8
	version = '0.1'

	buildDir = 'out/production/release'
	
	repositories {
	    mavenCentral()
	}
	configurations {
		provided
		compile.extendsFrom provided
	}

	dependencies {
		provided 'org.apache.tomcat:tomcat-servlet-api:8.0.36'
	    testCompile group: 'junit', name: 'junit', version: '4.12'
	}

	task copyToLib(type: Copy) {
		into '$buildDir'
		from subprojects.collect {
			configurations.runtime - configurations.provided
		}
	}

	build.dependsOn(copyToLib)

	distZip.shouldRunAfter(build)
}